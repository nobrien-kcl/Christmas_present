
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Christmas Present Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
 body { font-family: Arial, sans-serif; background:#111; color:#eee; margin:0; padding:20px; }
 h1 { text-align:center; }
 .game { max-width:400px; margin:20px auto; }
 .row { display:flex; justify-content:center; margin:4px 0;}
 .tile { width:44px; height:44px; border:2px solid #333; margin:2px;
         font-size:28px; display:flex; justify-content:center; align-items:center;
         text-transform:uppercase; font-weight:bold; }
 .correct { background:#6aaa64; border-color:#6aaa64; color:#fff; }
 .present { background:#c9b458; border-color:#c9b458; color:#fff; }
 .absent { background:#3a3a3c; border-color:#3a3a3c; color:#fff; }
 .hidden { display:none; }
 #reveal { text-align:center; margin-top:20px; font-size:20px; display:none; }
 input[type=text] { width:100%; font-size:20px; padding:8px; margin-top:10px; }
 button { width:100%; padding:10px; margin-top:6px; font-size:18px; }
</style>
</head>

<body>
<h1>Christmas Present Puzzle</h1>

<div id="game1" class="game">
  <h2>Puzzle 1 (4 letters)</h2>
  <div id="grid1"></div>
  <div id="msg1"></div>
  <input id="guess1" maxlength="4" placeholder="4-letter word">
  <button onclick="submitGuess(1)">Guess</button>
</div>

<div id="game2" class="game hidden">
  <h2>Puzzle 2 (6 letters)</h2>
  <div id="grid2"></div>
  <div id="msg2"></div>
  <input id="guess2" maxlength="6" placeholder="6-letter word">
  <button onclick="submitGuess(2)">Guess</button>
</div>

<canvas id="confetti" class="hidden"></canvas>

<div id="reveal">
  ðŸŽ‰ SNOW PATROL in Crystal Palace Park â€” July 2026!
</div>

<script>
const ANSWERS = {1:"snow", 2:"patrol"};
const MAX_GUESSES = 6;

let state = {
  1:{tries:0},
  2:{tries:0}
};

function createGrid(n,len){
  const grid=document.getElementById("grid"+n);
  for(let r=0;r<MAX_GUESSES;r++){
    const row=document.createElement("div");
    row.className="row";
    for(let c=0;c<len;c++){
      const tile=document.createElement("div");
      tile.className="tile";
      tile.id=`t-${n}-${r}-${c}`;
      row.appendChild(tile);
    }
    grid.appendChild(row);
  }
}
createGrid(1,4);
createGrid(2,6);

// Simple word validation: letters only & correct length
function validWord(g,len){
  return g.length===len && /^[a-zA-Z]+$/.test(g);
}

function submitGuess(n){
  const input=document.getElementById("guess"+n);
  const msg=document.getElementById("msg"+n);

  let g=input.value.toLowerCase();
  input.value="";

  if(!validWord(g,ANSWERS[n].length)){msg.textContent="Invalid word";return;}

  let row=state[n].tries;
  if(row>=MAX_GUESSES){msg.textContent="No guesses left";return;}

  let ans=ANSWERS[n];
  let result=Array(g.length).fill("absent");

  let freq={};
  for(let ch of ans){freq[ch]=(freq[ch]||0)+1;}

  for(let i=0;i<g.length;i++){
    if(g[i]===ans[i]){
      result[i]="correct";
      freq[g[i]]--;
    }
  }

  for(let i=0;i<g.length;i++){
    if(result[i]==="correct") continue;
    if(freq[g[i]]>0){
      result[i]="present";
      freq[g[i]]--;
    }
  }

  for(let i=0;i<g.length;i++){
    let t=document.getElementById(`t-${n}-${row}-${i}`);
    t.textContent=g[i];
    t.classList.add(result[i]);
  }

  if(g===ans){
    msg.textContent="Correct!";
    if(n===1){
      document.getElementById("game2").classList.remove("hidden");
      msg.textContent="Great! Puzzle 2 unlocked!";
    } else {
      revealPrize();
    }
  } else {
    msg.textContent=(MAX_GUESSES-row-1)+" guesses left";
  }

  state[n].tries++;
}

function revealPrize(){
  document.getElementById("reveal").style.display="block";
  launchConfetti();
}

function launchConfetti(){
  const duration = 2000;
  const end = Date.now() + duration;
  const colors = ["#6aaa64","#c9b458","#3a3a3c","#ffffff"];

  (function frame(){
    for(let i=0;i<10;i++){
      createParticle(colors[Math.floor(Math.random()*colors.length)]);
    }
    if(Date.now()<end){
      requestAnimationFrame(frame);
    }
  })();
}

function createParticle(color){
  const particle=document.createElement("div");
  particle.style.position="fixed";
  particle.style.top=(Math.random()*100)+"%";
  particle.style.left=(Math.random()*100)+"%";
  particle.style.width="8px";
  particle.style.height="8px";
  particle.style.background=color;
  particle.style.opacity="1";
  particle.style.borderRadius="50%";
  particle.style.pointerEvents="none";
  particle.style.transition="all 2s linear";
  document.body.appendChild(particle);
  setTimeout(()=>{
    particle.style.transform="translateY(200px) rotate(720deg)";
    particle.style.opacity="0";
  },10);
  setTimeout(()=>{particle.remove();},2100);
}
</script>
</body>
</html>
